<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Welcome</title>
  <style>
    :root{
      /* Cursor position (updated by JS) */
      --mx: 50%;
      --my: 50%;

      /* Blue palette (no color-mix, widely supported) */
      --b0: #001b4d; /* deep */
      --b1: #002c73; /* your base */
      --b2: #004aae; /* royal */
      --b3: #0070d1; /* bright accent */

      --text: #ffffff;
      --shadow: 0 2px 6px rgba(0,0,0,0.65);
    }

    html, body { height: 100%; }
    body {
      margin: 0;
      min-height: 100vh;          /* ensure we cover full iframe area */
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
      color: var(--text);
      display: grid;
      place-items: center;
      padding: 24px;

      /* ----- Interactive background (compat-safe) -----
         Stack a base linear gradient with three radial glows
         (transparent edges so layers blend without color-mix).
      */
      background:
        /* glow 1 (cursor) */
        radial-gradient(500px circle at var(--mx) var(--my),
          rgba(0,112,209,0.70) 0%,
          rgba(0,74,174,0.55) 35%,
          rgba(0,0,0,0.00) 60%),
        /* glow 2 (slight vertical offset) */
        radial-gradient(900px circle at var(--mx) calc((var(--my) + 14%)),
          rgba(0,74,174,0.45) 0%,
          rgba(0,44,115,0.35) 45%,
          rgba(0,0,0,0.00) 80%),
        /* glow 3 (slight diagonal offset) */
        radial-gradient(1200px circle at calc((var(--mx) + 12%)) calc((var(--my) - 8%)),
          rgba(0,44,115,0.35) 0%,
          rgba(0,0,0,0.00) 60%),
        /* base gradient */
        linear-gradient(135deg, var(--b0) 0%, var(--b1) 40%, var(--b2) 70%, var(--b0) 100%);
      background-repeat: no-repeat;
      background-size: cover;
      /* background-attachment: fixed;  <-- avoid inside SharePoint iframes */
      box-shadow: inset 0 0 180px rgba(0,0,0,0.25); /* subtle vignette */
    }

    .wrap {
      text-align: center;
      max-width: 900px;
      width: 100%;
    }
    h1 {
      margin: 0 0 12px 0;
      font-size: clamp(28px, 6vw, 56px);
      line-height: 1.1;
      letter-spacing: 0.2px;
      text-shadow: 0 1px 0 #000, 0 2px 0 #000, 0 3px 10px rgba(0,0,0,0.5);
      font-weight: 800;
    }
    .name-inline {
      font-weight: 800;
      text-decoration: none; /* no underline */
      border: none;
    }
    .sub {
      font-size: clamp(16px, 2.6vw, 22px);
      opacity: 0.98;
      margin: 0;
      text-shadow: var(--shadow);
    }

    @media (prefers-reduced-motion: no-preference) {
      .fade-in { animation: fade 520ms ease-out both; }
      @keyframes fade { from { opacity: 0; transform: translateY(8px) } to { opacity: 1; transform: translateY(0) } }
    }

    /* Reduced motion: keep glow static */
    @media (prefers-reduced-motion: reduce) {
      :root {
        --mx: 50%;
        --my: 45%;
      }
    }
  </style>
</head>
<body>
  <main class="wrap fade-in" role="main" aria-live="polite">
    <h1>Welcome <span id="userName" class="name-inline">User</span></h1>
    <p class="sub">What do you need help with today?</p>
  </main>

  <script>
    // ========== SharePoint username ==========
    (function () {
      const userNameEl = document.getElementById('userName');
      const setName = (n) => { if (n) userNameEl.textContent = n; };

      try {
        if (window._spPageContextInfo && _spPageContextInfo.userDisplayName) {
          setName(_spPageContextInfo.userDisplayName);
        } else {
          fetch('/_api/web/currentuser', {
            headers: { 'Accept': 'application/json;odata=nometadata' },
            credentials: 'include'
          })
          .then(r => r.ok ? r.json() : null)
          .then(d => {
            if (!d) return;
            setName(d.Title || (d.LoginName ? d.LoginName.split('|').pop() : 'User'));
          })
          .catch(() => {});
        }
      } catch (_) {}
    })();

    // ========== Cursor-following glow ==========
    (function () {
      const r = document.documentElement;
      const body = document.body;
      let raf = null;
      let targetX = 0.5, targetY = 0.5; // normalized
      let animX = targetX, animY = targetY;

      const reduce = matchMedia('(prefers-reduced-motion: reduce)').matches;

      function tick() {
        const k = 0.18; // easing
        animX += (targetX - animX) * k;
        animY += (targetY - animY) * k;
        r.style.setProperty('--mx', (animX * 100).toFixed(3) + '%');
        r.style.setProperty('--my', (animY * 100).toFixed(3) + '%');
        raf = requestAnimationFrame(tick);
      }

      function setTargetFromClient(x, y) {
        const w = window.innerWidth || body.clientWidth || 1;
        const h = window.innerHeight || body.clientHeight || 1;
        targetX = Math.min(1, Math.max(0, x / w));
        targetY = Math.min(1, Math.max(0, y / h));
      }

      function startIfNeeded() {
        if (raf === null && !reduce) raf = requestAnimationFrame(tick);
      }

      window.addEventListener('mousemove', (e) => {
        setTargetFromClient(e.clientX, e.clientY);
        startIfNeeded();
      }, { passive: true });

      window.addEventListener('touchmove', (e) => {
        const t = e.touches && e.touches[0];
        if (!t) return;
        setTargetFromClient(t.clientX, t.clientY);
        startIfNeeded();
      }, { passive: true });

      // Nice initial position
      if (!reduce) {
        const cx = (window.innerWidth || document.body.clientWidth || 1) / 2;
        const cy = (window.innerHeight || document.body.clientHeight || 1) * 0.45;
        setTargetFromClient(cx, cy);
        startIfNeeded();
      }
    })();
  </script>
</body>
</html>
